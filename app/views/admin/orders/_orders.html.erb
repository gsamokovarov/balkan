<%# locals: (orders:) %>

<%= admin_table orders do
  column "#", -> { link_to it.id, admin_order_path(it) }

  column :status do |order|
    if order.refunded?
      admin_badge :danger, "Refunded", title: format_money(order.refunded_amount)
    elsif order.free?
      admin_badge :warning, "Free", title: order.free_reason
    else
      admin_badge :success, "Completed"
    end
  end

  column :name,    -> { link_to truncate(it.name, length: 20), admin_order_path(it), title: it.name }
  column :email,   -> { link_to truncate(it.email, length: 20), admin_order_path(it), title: it.name }
  column :date,    -> { it.completed_at.to_date.iso8601 }
  column :event,   -> { it.event.name }
  column :invoice, -> { it.issue_invoice? ? "Yes" : "No" }
  column :price,   -> { format_money it.amount }
end %>
