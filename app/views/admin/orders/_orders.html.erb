<%# locals: (orders:) %>

<%= admin_table orders do
  column "#", -> { link_to _1.id, admin_order_path(_1) }

  column :status do |order|
    if order.refunded?
      admin_badge :danger, "Refunded", title: format_money(order.refunded_amount)
    elsif order.free?
      admin_badge :warning, "Free", title: order.free_reason
    else
      admin_badge :success, "Completed"
    end
  end

  column :name,    -> { link_to _1.name, admin_order_path(_1) }
  column :email
  column :date,    -> { _1.completed_at.to_date.iso8601 }
  column :event,   -> { _1.event.name }
  column :invoice, -> { _1.issue_invoice? ? "Yes" : "No" }
  column :price,   -> { format_money _1.amount }
end %>
