<%# locals: (invoices:) %>

<%= admin_table invoices do
  column "#", -> { link_to it.id, admin_invoice_path(it), class: "text-indigo-600 hover:underline" }
  column :number, -> { it.prefixed_number }

  column :status do |invoice|
    if invoice.credit_note?
      admin_badge :danger, "Credit note"
    elsif invoice.refunded?
      admin_badge :warning, "Refunded"
    elsif invoice.manual?
      admin_badge :primary, "Manual"
    else
      admin_badge :success, "Invoice"
    end
  end

  column :customer do |invoice|
    customer = invoice.customer_name || invoice.receiver_company_name || invoice.order&.name
    tag.span truncate(customer, length: 30), title: customer
  end

  column :issue_date, -> { (it.issue_date || it.created_at.to_date).iso8601 }
  column :total, -> { format_money it.total_amount }
end %>
